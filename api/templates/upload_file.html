{% extends 'layouts/base.html' %}
{% block title %}
    <title>Dashboard | HealthPulse</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">

{% endblock title %}
{% block content %}
<main class="main">
    <div class="main_wrapper">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div class="alert_box">
            {% for category,message in messages %}
            <div class="alert alert-{{category}}">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}
        <div class="card">
        {% if user %}
            <h2>Welcome, {{ user.name }}</h2>
            <form action="/upload/{{ user.uuid }}" method="POST" enctype="multipart/form-data">
                <label for="file">Choose a file:</label>
                <input type="file" name="file" id="file" >
                <br>
                <input type="submit" value="Upload">
            </form>

            
            {% if profile_data.image_files and profile_data.image_files|length > 0 %}
            {% set first_image = profile_data.image_files[0] %}
            <img src="{{ url_for('fetch', file_id=first_image.file_id) }}" alt="User Image">
        {% else %}
            <p>No profile image available.</p>
        {% endif %}
    {% endif %}

        {% endif %}

        </div>
    </div>
</main>



{% endblock content %}